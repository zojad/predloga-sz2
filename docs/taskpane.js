!function(){"use strict";const e={errors:[]},t="noErrors";function o(e,t){Office.NotificationMessages?.addAsync&&Office.NotificationMessages.addAsync(e,t)}function n(e){if(!e)return null;const t=e.normalize("NFC").match(/[\p{L}0-9]/u);if(!t)return null;const o=t[0].toLowerCase(),n=new Set(["c","č","f","h","k","p","s","š","t"]),s=/\d/.test(o)?{1:"e",2:"d",3:"t",4:"š",5:"p",6:"š",7:"s",8:"o",9:"d",0:"n"}[o]:o;return n.has(s)?"s":"z"}async function s(){var s;s=t,Office.NotificationMessages?.deleteAsync&&Office.NotificationMessages.deleteAsync(s),e.errors=[],await Word.run((async s=>{s.document.body.search("s",{matchWholeWord:!0,matchCase:!1}).load("items"),s.document.body.search("z",{matchWholeWord:!0,matchCase:!1}).load("items"),await s.sync(),[...s.document.body.search("s",{matchWholeWord:!0,matchCase:!1}).items,...s.document.body.search("z",{matchWholeWord:!0,matchCase:!1}).items].forEach((e=>e.font.highlightColor=null)),await s.sync();const r=s.document.body.search("s",{matchWholeWord:!0,matchCase:!1}),c=s.document.body.search("z",{matchWholeWord:!0,matchCase:!1});r.load("items"),c.load("items"),await s.sync();const a=[...r.items,...c.items].filter((e=>{const t=e.text.trim().toLowerCase();return"s"===t||"z"===t}));for(const t of a){const o=t.getRange("After").getNextTextRange([" ","\n",".",",",";","?","!"],!0);o.load("text"),await s.sync();const r=o.text.trim();if(!r)continue;const c=t.text.trim().toLowerCase(),a=n(r);a&&c!==a&&(s.trackedObjects.add(t),t.font.highlightColor="#FFC0CB",e.errors.push({range:t,suggestion:a}))}if(e.errors.length){const t=e.errors[0].range;s.trackedObjects.add(t),t.select(),await s.sync()}else o(t,{type:"informationalMessage",message:"✨ No mismatches!",icon:"Icon.80x80"})}))}async function r(){if(!e.errors.length)return;const{suggestion:t}=e.errors.shift();await Word.run((async o=>{const n=o.document.getSelection();if(n.insertText(t,Word.InsertLocation.replace),n.font.highlightColor=null,e.errors.length){const t=e.errors[0].range;o.trackedObjects.add(t),t.select()}await o.sync()}))}async function c(){e.errors.length&&(e.errors.shift(),await Word.run((async t=>{if(t.document.getSelection().font.highlightColor=null,e.errors.length){const o=e.errors[0].range;t.trackedObjects.add(o),o.select()}await t.sync()})))}async function a(){e.errors.length&&(await Word.run((async t=>{for(const o of e.errors)t.load(o.range,"text");await t.sync();for(const{range:t,suggestion:o}of e.errors)t.insertText(o,Word.InsertLocation.replace),t.font.highlightColor=null;await t.sync()})),e.errors=[],o(t,{type:"informationalMessage",message:"Accepted all!",icon:"Icon.80x80"}))}async function i(){e.errors.length&&(await Word.run((async t=>{for(const t of e.errors)t.range.font.highlightColor=null;await t.sync()})),e.errors=[],o(t,{type:"informationalMessage",message:"Cleared all!",icon:"Icon.80x80"}))}Office.onReady((e=>{e.host===Office.HostType.Word&&(document.getElementById("checkTextButton").onclick=s,document.getElementById("acceptChangeButton").onclick=r,document.getElementById("rejectChangeButton").onclick=c,document.getElementById("acceptAllButton").onclick=a,document.getElementById("rejectAllButton").onclick=i)}))}();
//# sourceMappingURL=taskpane.js.map