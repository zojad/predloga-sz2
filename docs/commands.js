!function(){"use strict";let e={errors:[],isChecking:!1};const t="noErrors";function o(e){Office.NotificationMessages?.deleteAsync&&Office.NotificationMessages.deleteAsync(e)}function n(e,t){Office.NotificationMessages?.addAsync&&Office.NotificationMessages.addAsync(e,t)}function c(e){if(!e)return null;const t=e.normalize("NFC").match(/[\p{L}0-9]/u);if(!t)return null;const o=t[0].toLowerCase(),n=new Set(["c","Ä","f","h","k","p","s","Å¡","t"]),c=/\d/.test(o)?{1:"e",2:"d",3:"t",4:"Å¡",5:"p",6:"Å¡",7:"s",8:"o",9:"d",0:"n"}[o]:o;return n.has(c)?"s":"z"}async function s(){if(!e.isChecking){e.isChecking=!0,o(t),e.errors=[];try{await Word.run((async o=>{o.document.body.font.highlightColor=null,await o.sync();const s={matchWholeWord:!0,matchCase:!1},a=o.document.body.search("s",s),i=o.document.body.search("z",s);a.load("items"),i.load("items"),await o.sync();for(const t of[...a.items,...i.items]){const n=t.text.trim();if(!/^[sSzZ]$/.test(n))continue;const s=t.getRange("After").getNextTextRange([" ","\n",".",",",";","?","!"],!0);s.load("text"),await o.sync();const a=s.text.trim();if(!a)continue;const i=c(a);if(!i||i===n.toLowerCase())continue;const r=n===n.toUpperCase()?i.toUpperCase():i;t.font.highlightColor="#FFC0CB",e.errors.push({range:t,suggestion:r})}await o.sync(),e.errors.length?(e.errors[0].range.select(),await o.sync()):n(t,{type:"informationalMessage",message:"âœ¨ No mismatches!",icon:"Icon.80x80"})}))}catch(e){console.error("checkDocumentText error",e),n(t,{type:"errorMessage",message:"Check failed; please try again."})}finally{e.isChecking=!1}}}console.log("â­ commands.js loaded"),Office.onReady((a=>{console.log("â–¶ï¸ Office.onReady",a),a.host===Office.HostType.Word&&(console.log("ðŸ”— Associating actionsâ€¦"),Office.actions.associate("checkDocumentText",(async e=>{console.log("â–¶ï¸ OfficeAction invoked: checkDocumentText");try{await s()}catch(e){console.error("checkDocumentText threw",e)}finally{e.completed()}})),Office.actions.associate("acceptCurrentChange",(async t=>{console.log("â–¶ï¸ OfficeAction invoked: acceptCurrentChange");try{await async function(){if(!e.errors.length)return;const{range:t,suggestion:o}=e.errors.shift();await Word.run((async e=>{t.insertText(o,Word.InsertLocation.replace),t.font.highlightColor=null,await e.sync()})),await s()}()}catch(e){console.error("acceptCurrentChange threw",e)}finally{t.completed()}})),Office.actions.associate("rejectCurrentChange",(async t=>{console.log("â–¶ï¸ OfficeAction invoked: rejectCurrentChange");try{await async function(){if(!e.errors.length)return;const{range:t}=e.errors.shift();await Word.run((async e=>{t.font.highlightColor=null,await e.sync()})),await s()}()}catch(e){console.error("rejectCurrentChange threw",e)}finally{t.completed()}})),Office.actions.associate("acceptAllChanges",(async s=>{console.log("â–¶ï¸ OfficeAction invoked: acceptAllChanges");try{await async function(){o(t),await Word.run((async e=>{const t={matchWholeWord:!0,matchCase:!1},o=e.document.body.search("s",t),n=e.document.body.search("z",t);o.load("items"),n.load("items"),await e.sync();for(const t of[...o.items,...n.items]){const o=t.text.trim();if(!/^[sSzZ]$/.test(o))continue;const n=t.getRange("After").getNextTextRange([" ","\n",".",",",";","?","!"],!0);n.load("text"),await e.sync();const s=n.text.trim();if(!s)continue;const a=c(s);if(!a||a===o.toLowerCase())continue;const i=o===o.toUpperCase()?a.toUpperCase():a;t.insertText(i,Word.InsertLocation.replace),t.font.highlightColor=null}await e.sync()})),e.errors=[],n(t,{type:"informationalMessage",message:"Accepted all!",icon:"Icon.80x80"})}()}catch(e){console.error("acceptAllChanges threw",e)}finally{s.completed()}})),Office.actions.associate("rejectAllChanges",(async c=>{console.log("â–¶ï¸ OfficeAction invoked: rejectAllChanges");try{await async function(){o(t),await Word.run((async e=>{const t={matchWholeWord:!0,matchCase:!1},o=e.document.body.search("s",t),n=e.document.body.search("z",t);o.load("items"),n.load("items"),await e.sync();for(const e of[...o.items,...n.items])/^[sSzZ]$/.test(e.text.trim())&&(e.font.highlightColor=null);await e.sync()})),e.errors=[],n(t,{type:"informationalMessage",message:"Cleared all!",icon:"Icon.80x80"})}()}catch(e){console.error("rejectAllChanges threw",e)}finally{c.completed()}})),console.log("âœ… Actions associated"))}))}();
//# sourceMappingURL=commands.js.map