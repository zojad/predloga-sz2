!function(){const e={errors:[],currentIndex:0};async function r(){try{await Word.run((async r=>{e.errors.forEach((e=>{e.range.font.highlightColor=null})),e.errors=[],e.currentIndex=0;const n={matchCase:!1,matchWholeWord:!0},t=r.document.body.search("s",n),o=r.document.body.search("z",n);t.load("items"),o.load("items"),await r.sync();const c=[...t.items,...o.items].filter((e=>["s","z"].includes(e.text.trim().toLowerCase()))).map((e=>({prepositionRange:e,nextWordRange:e.getNextTextRange(Word.TextRangeUnit.word)})));c.forEach((e=>e.nextWordRange.load("text"))),await r.sync(),e.errors=c.map((e=>{let{prepositionRange:r,nextWordRange:n}=e;const t=r.text.trim().toLowerCase(),o=function(e){if(!e)return null;const r=new Set(["c","č","f","h","k","p","s","š","t"]),n={1:"e",2:"d",3:"t",4:"š",5:"p",6:"š",7:"s",8:"o",9:"d",0:"n"};let t="";for(const r of e)if(r.match(/[a-zA-ZčČšŠžŽ0-9]/)){t=r.toLowerCase();break}if(!t)return null;if(t>="0"&&t<="9"){const e=n[t];return r.has(e)?"s":"z"}return r.has(t)?"s":"z"}(n.text.trim());return o&&t!==o?{range:r,suggestion:o}:null})).filter(Boolean),e.errors.forEach((e=>{e.range.font.highlightColor="Yellow"})),await r.sync(),e.errors.length>0?e.errors[0].range.select():r.document.body.insertComment("No preposition errors found.","start")}))}catch(e){console.error("Document check failed:",e)}}async function n(){if(!(e.currentIndex>=e.errors.length))try{await Word.run((async r=>{const n=e.errors[e.currentIndex];n.range.insertText(n.suggestion,Word.InsertLocation.replace),n.range.font.highlightColor=null,await r.sync(),e.currentIndex++,e.currentIndex<e.errors.length&&e.errors[e.currentIndex].range.select()}))}catch(e){console.error("Failed to accept change:",e)}}async function t(){if(!(e.currentIndex>=e.errors.length))try{await Word.run((async r=>{e.errors[e.currentIndex].range.font.highlightColor=null,await r.sync(),e.currentIndex++,e.currentIndex<e.errors.length&&e.errors[e.currentIndex].range.select()}))}catch(e){console.error("Failed to reject change:",e)}}async function o(){if(0!==e.errors.length)try{await Word.run((async r=>{for(const r of e.errors)r.range.insertText(r.suggestion,Word.InsertLocation.replace),r.range.font.highlightColor=null;await r.sync(),e.errors=[]}))}catch(e){console.error("Failed to accept all changes:",e)}}async function c(){if(0!==e.errors.length)try{await Word.run((async r=>{for(const r of e.errors)r.range.font.highlightColor=null;await r.sync(),e.errors=[]}))}catch(e){console.error("Failed to reject all changes:",e)}}Office.onReady((e=>{if(e.host===Office.HostType.Word)try{Office.actions.associate("checkDocumentText",r),Office.actions.associate("acceptAllChanges",o),Office.actions.associate("rejectAllChanges",c),Office.actions.associate("acceptCurrentChange",n),Office.actions.associate("rejectCurrentChange",t)}catch(e){console.error("Function registration failed:",e)}})),window.checkDocumentText=r,window.acceptAllChanges=o,window.rejectAllChanges=c,window.acceptCurrentChange=n,window.rejectCurrentChange=t}();
//# sourceMappingURL=commands.js.map