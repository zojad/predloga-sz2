!function(){const e={errors:[],currentIndex:0};function r(e){if(!e)return null;const r=new Set(["c","č","f","h","k","p","s","š","t"]),t={1:"e",2:"d",3:"t",4:"š",5:"p",6:"š",7:"s",8:"o",9:"d",0:"n"};let n="";for(const r of e)if(r.match(/[a-zA-ZčČšŠžŽ0-9]/)){n=r.toLowerCase();break}if(!n)return null;if(n>="0"&&n<="9"){const e=t[n];return r.has(e)?"s":"z"}return r.has(n)?"s":"z"}async function t(){try{await Word.run((async t=>{e.errors.forEach((e=>{e.range.font.highlightColor=null})),e.errors=[],e.currentIndex=0;const n={matchCase:!1,matchWholeWord:!0},o=[t.document.body,t.document.sections.getFirst().getHeader("Primary"),t.document.sections.getFirst().getFooter("Primary")];let c=[];for(const e of o){const r=e.search("s",n),o=e.search("z",n);r.load("items"),o.load("items"),await t.sync(),c.push(...r.items,...o.items)}const a=c.filter((e=>["s","z"].includes(e.text.trim().toLowerCase()))),s=[];for(const e of a)try{const n=e.getRange("After");n.expandTo(Word.TextRangeUnit.word),n.load("text"),await t.sync();const o=e.text.trim().toLowerCase(),c=r(n.text.trim());c&&o!==c&&s.push({range:e,suggestion:c})}catch(r){console.warn("Failed to get following word for:",e.text,r)}e.errors=s,e.errors.forEach((e=>{e.range.font.highlightColor="Yellow"})),await t.sync(),e.errors.length>0?e.errors[0].range.select():console.log("No preposition errors found.")}))}catch(e){console.error("Document check failed:",e)}}async function n(){if(!(e.currentIndex>=e.errors.length))try{await Word.run((async r=>{const t=e.errors[e.currentIndex];t.range.insertText(t.suggestion,Word.InsertLocation.replace),t.range.font.highlightColor=null,await r.sync(),e.currentIndex++,e.currentIndex<e.errors.length&&e.errors[e.currentIndex].range.select()}))}catch(e){console.error("Failed to accept change:",e)}}async function o(){if(!(e.currentIndex>=e.errors.length))try{await Word.run((async r=>{e.errors[e.currentIndex].range.font.highlightColor=null,await r.sync(),e.currentIndex++,e.currentIndex<e.errors.length&&e.errors[e.currentIndex].range.select()}))}catch(e){console.error("Failed to reject change:",e)}}async function c(){if(0!==e.errors.length)try{await Word.run((async r=>{for(const r of e.errors)r.range.insertText(r.suggestion,Word.InsertLocation.replace),r.range.font.highlightColor=null;await r.sync(),e.errors=[]}))}catch(e){console.error("Failed to accept all changes:",e)}}async function a(){if(0!==e.errors.length)try{await Word.run((async r=>{for(const r of e.errors)r.range.font.highlightColor=null;await r.sync(),e.errors=[]}))}catch(e){console.error("Failed to reject all changes:",e)}}Office.onReady((e=>{if(e.host===Office.HostType.Word)try{Office.actions.associate("checkDocumentText",t),Office.actions.associate("acceptAllChanges",c),Office.actions.associate("rejectAllChanges",a),Office.actions.associate("acceptCurrentChange",n),Office.actions.associate("rejectCurrentChange",o)}catch(e){console.error("Function registration failed:",e)}})),window.checkDocumentText=t,window.acceptAllChanges=c,window.rejectAllChanges=a,window.acceptCurrentChange=n,window.rejectCurrentChange=o}();
//# sourceMappingURL=commands.js.map