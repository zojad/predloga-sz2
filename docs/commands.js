!function(){"use strict";let e={errors:[]};const t="noErrors";function o(e,t){Office.NotificationMessages?.addAsync&&Office.NotificationMessages.addAsync(e,t)}function a(e){if(!e)return null;const t=e.normalize("NFC").match(/[\p{L}0-9]/u);if(!t)return null;const o=t[0].toLowerCase(),a=new Set(["c","č","f","h","k","p","s","š","t"]),s=/\d/.test(o)?{1:"e",2:"d",3:"t",4:"š",5:"p",6:"š",7:"s",8:"o",9:"d",0:"n"}[o]:o;return a.has(s)?"s":"z"}async function s(){var s;s=t,Office.NotificationMessages?.deleteAsync&&Office.NotificationMessages.deleteAsync(s),e.errors=[];try{await Word.run((async s=>{const n=s.document.body.search("s",{matchWholeWord:!0,matchCase:!1}),c=s.document.body.search("z",{matchWholeWord:!0,matchCase:!1});n.load("items"),c.load("items"),await s.sync(),[...n.items,...c.items].forEach((e=>e.font.highlightColor=null)),await s.sync();const r=s.document.body.search("s",{matchWholeWord:!0,matchCase:!1}),i=s.document.body.search("z",{matchWholeWord:!0,matchCase:!1});r.load("items"),i.load("items"),await s.sync();for(const t of[...r.items,...i.items]){const o=t.text.trim();if(!/^[sSzZ]$/.test(o))continue;const n=t.getRange("After").getNextTextRange([" ","\n",".",",",";","?","!"],!0);n.load("text"),await s.sync();const c=n.text.trim();if(!c)continue;const r=a(c);if(!r||o.toLowerCase()===r)continue;const i=o===o.toUpperCase()?r.toUpperCase():r;s.trackedObjects.add(t),t.font.highlightColor="#FFC0CB",e.errors.push({range:t,suggestion:i})}if(await s.sync(),e.errors.length){const t=e.errors[0].range;s.trackedObjects.add(t),t.select(),await s.sync()}else o(t,{type:"informationalMessage",message:"✨ No mismatches!",icon:"Icon.80x80"})}))}catch(e){console.error("checkDocumentText error",e),o(t,{type:"errorMessage",message:"Check failed; please try again."})}}console.log("⭐ commands.js loaded"),Office.onReady((a=>{a.host===Office.HostType.Word&&(Office.actions.associate("checkDocumentText",(async e=>{console.log("▶️ checkDocumentText"),await s(),e.completed()})),Office.actions.associate("acceptCurrentChange",(async t=>{console.log("▶️ acceptCurrentChange"),await async function(){if(!e.errors.length)return;const{range:t,suggestion:o}=e.errors.shift();await Word.run((async e=>{e.trackedObjects.add(t),t.insertText(o,Word.InsertLocation.replace),t.font.highlightColor=null,await e.sync()})),await s()}(),t.completed()})),Office.actions.associate("rejectCurrentChange",(async t=>{console.log("▶️ rejectCurrentChange"),await async function(){if(!e.errors.length)return;const{range:t}=e.errors.shift();await Word.run((async e=>{e.trackedObjects.add(t),t.font.highlightColor=null,await e.sync()})),await s()}(),t.completed()})),Office.actions.associate("acceptAllChanges",(async a=>{console.log("▶️ acceptAllChanges"),await async function(){e.errors.length&&(await Word.run((async t=>{for(const{range:o,suggestion:a}of e.errors)t.trackedObjects.add(o),o.insertText(a,Word.InsertLocation.replace),o.font.highlightColor=null;await t.sync()})),e.errors=[],o(t,{type:"informationalMessage",message:"Accepted all!",icon:"Icon.80x80"}))}(),a.completed()})),Office.actions.associate("rejectAllChanges",(async a=>{console.log("▶️ rejectAllChanges"),await async function(){e.errors.length&&(await Word.run((async t=>{for(const{range:o}of e.errors)t.trackedObjects.add(o),o.font.highlightColor=null;await t.sync()})),e.errors=[],o(t,{type:"informationalMessage",message:"Cleared all!",icon:"Icon.80x80"}))}(),a.completed()})))}))}();
//# sourceMappingURL=commands.js.map