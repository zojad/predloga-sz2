!function(){function e(e,r){Office.NotificationMessages&&"function"==typeof Office.NotificationMessages.addAsync&&Office.NotificationMessages.addAsync(e,r)}const r={errors:[],currentIndex:0,isChecking:!1},t="noErrors";function n(e){if(!e)return null;const r=e.normalize("NFC").charAt(0).toLowerCase(),t=new Set(["c","Ä","f","h","k","p","s","Å¡","t"]);if(r>="0"&&r<="9"){const e={1:"e",2:"d",3:"t",4:"Å¡",5:"p",6:"Å¡",7:"s",8:"o",9:"d",0:"n"}[r];return t.has(e)?"s":"z"}return t.has(r)?"s":"z"}async function s(){if(!r.isChecking){var s;r.isChecking=!0,s=t,Office.NotificationMessages&&"function"==typeof Office.NotificationMessages.deleteAsync&&Office.NotificationMessages.deleteAsync(s);try{await Word.run((async s=>{r.errors.forEach((e=>e.range.font.highlightColor=null)),r.errors=[],r.currentIndex=0;const a={matchCase:!1,matchWholeWord:!0};let o=[];await async function(e){const r=e.search("\\b[sz]\\b",a);r.load("items"),await s.sync(),o.push(...r.items)}(s.document.body);const c=o.filter((e=>["s","z"].includes(e.text.trim().toLowerCase()))),i=[];for(const e of c){const r=e.getRange("After");r.expandTo(Word.TextRangeUnit.word),r.load("text"),await s.sync();const t=r.text.trim();if(!t)continue;const a=e.text.trim().toLowerCase(),o=n(t);o&&a!==o&&i.push({range:e,suggestion:o})}if(r.errors=i,0!==i.length){for(const e of i)e.range.font.highlightColor="#FFC0CB";await s.sync(),i[0].range.select(),await s.sync()}else e(t,{type:"informationalMessage",message:"ðŸŽ‰ Ni najdenih napak.",icon:"Icon.80x80",persistent:!1})}))}catch(r){console.error("checkDocumentText failed:",r),e("checkError",{type:"errorMessage",message:"Preposition check failed. Please try again.",persistent:!1})}finally{r.isChecking=!1}}}async function a(){if(!(r.currentIndex>=r.errors.length))try{await Word.run((async e=>{const t=r.errors[r.currentIndex];t.range.insertText(t.suggestion,Word.InsertLocation.replace),t.range.font.highlightColor=null,await e.sync(),r.currentIndex++,r.currentIndex<r.errors.length&&(r.errors[r.currentIndex].range.select(),await e.sync())}))}catch(r){console.error("acceptCurrentChange failed:",r),e("acceptError",{type:"errorMessage",message:"Failed to apply change. Please re-run the check.",persistent:!1})}}async function o(){if(!(r.currentIndex>=r.errors.length))try{await Word.run((async e=>{r.errors[r.currentIndex].range.font.highlightColor=null,await e.sync(),r.currentIndex++,r.currentIndex<r.errors.length&&(r.errors[r.currentIndex].range.select(),await e.sync())}))}catch(r){console.error("rejectCurrentChange failed:",r),e("rejectError",{type:"errorMessage",message:"Failed to reject change. Please re-run the check.",persistent:!1})}}async function c(){if(r.errors.length)try{await Word.run((async e=>{for(const e of r.errors)e.range.insertText(e.suggestion,Word.InsertLocation.replace),e.range.font.highlightColor=null;await e.sync(),r.errors=[]}))}catch(r){console.error("acceptAllChanges failed:",r),e("acceptAllError",{type:"errorMessage",message:"Failed to apply all changes. Please try again.",persistent:!1})}}async function i(){if(r.errors.length)try{await Word.run((async e=>{for(const e of r.errors)e.range.font.highlightColor=null;await e.sync(),r.errors=[]}))}catch(r){console.error("rejectAllChanges failed:",r),e("rejectAllError",{type:"errorMessage",message:"Failed to clear changes. Please try again.",persistent:!1})}}Office.onReady((r=>{if(r.host===Office.HostType.Word)try{Office.actions.associate("checkDocumentText",s),Office.actions.associate("acceptAllChanges",c),Office.actions.associate("rejectAllChanges",i),Office.actions.associate("acceptCurrentChange",a),Office.actions.associate("rejectCurrentChange",o)}catch(r){console.error("Function registration failed:",r),e("regError",{type:"errorMessage",message:"Add-in initialization failed. Please reload.",persistent:!1})}})),window.checkDocumentText=s,window.acceptCurrentChange=a,window.rejectCurrentChange=o,window.acceptAllChanges=c,window.rejectAllChanges=i}();
//# sourceMappingURL=commands.js.map