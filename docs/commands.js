!function(){"use strict";let e={errors:[],isChecking:!1};const t="noErrors";function s(e){Office.NotificationMessages?.deleteAsync&&Office.NotificationMessages.deleteAsync(e)}function o(e,t){Office.NotificationMessages?.addAsync&&Office.NotificationMessages.addAsync(e,t)}function a(e){if(!e)return null;const t=e.normalize("NFC").match(/[\p{L}0-9]/u);if(!t)return null;const s=t[0].toLowerCase(),o=new Set(["c","č","f","h","k","p","s","š","t"]),a=/\d/.test(s)?{1:"e",2:"d",3:"t",4:"š",5:"p",6:"š",7:"s",8:"o",9:"d",0:"n"}[s]:s;return o.has(a)?"s":"z"}async function c(){if(!e.isChecking){e.isChecking=!0,s(t),e.errors=[];try{await Word.run((async s=>{const c=s.document.body.search("s",{matchWholeWord:!0,matchCase:!1}),n=s.document.body.search("z",{matchWholeWord:!0,matchCase:!1});c.load("items"),n.load("items"),await s.sync(),[...c.items,...n.items].forEach((e=>e.font.highlightColor=null)),await s.sync();const i=s.document.body.search("s",{matchWholeWord:!0,matchCase:!1}),r=s.document.body.search("z",{matchWholeWord:!0,matchCase:!1});i.load("items"),r.load("items"),await s.sync();for(const t of[...i.items,...r.items]){const o=t.text.trim();if(!/^[sSzZ]$/.test(o))continue;const c=t.getRange("After").getNextTextRange([" ","\n",".",",",";","?","!"],!0);c.load("text"),await s.sync();const n=c.text.trim();if(!n)continue;const i=a(n);if(i&&o.toLowerCase()!==i){const a=o===o.toUpperCase()?i.toUpperCase():i;s.trackedObjects.add(t),t.font.highlightColor="#FFC0CB",e.errors.push({range:t,suggestion:a})}}if(await s.sync(),e.errors.length){const t=e.errors[0].range;s.trackedObjects.add(t),t.select(),await s.sync()}else o(t,{type:"informationalMessage",message:"✨ No mismatches!",icon:"Icon.80x80"})}))}catch(e){console.error("checkDocumentText error",e),o(t,{type:"errorMessage",message:"Check failed; please try again."})}finally{e.isChecking=!1}}}console.log("⭐ commands.js loaded"),Office.onReady((n=>{n.host===Office.HostType.Word&&(Office.actions.associate("checkDocumentText",(async e=>{console.log("▶️ checkDocumentText"),await c(),e.completed()})),Office.actions.associate("acceptCurrentChange",(async t=>{console.log("▶️ acceptCurrentChange"),await async function(){if(!e.errors.length)return;const{range:t,suggestion:s}=e.errors.shift();await Word.run((async e=>{e.trackedObjects.add(t),t.insertText(s,Word.InsertLocation.replace),t.font.highlightColor=null,await e.sync()})),await c()}(),t.completed()})),Office.actions.associate("rejectCurrentChange",(async t=>{console.log("▶️ rejectCurrentChange"),await async function(){if(!e.errors.length)return;const{range:t}=e.errors.shift();await Word.run((async e=>{e.trackedObjects.add(t),t.font.highlightColor=null,await e.sync()})),await c()}(),t.completed()})),Office.actions.associate("acceptAllChanges",(async c=>{console.log("▶️ acceptAllChanges"),await async function(){s(t),await Word.run((async t=>{const s={matchWholeWord:!0,matchCase:!1},o=t.document.body.search("s",s),c=t.document.body.search("z",s);o.load("items"),c.load("items"),await t.sync();for(const e of[...o.items,...c.items]){const s=e.text.trim().toLowerCase();if("s"===s||"z"===s){const o=e.getRange("After").getNextTextRange([" ","\n",".",",",";","?","!"],!0);o.load("text"),await t.sync();const c=a(o.text.trim());c&&s!==c&&(t.trackedObjects.add(e),e.insertText(e.text===e.text.toUpperCase()?c.toUpperCase():c,Word.InsertLocation.replace),e.font.highlightColor=null)}}await t.sync(),e.errors=[]})),o(t,{type:"informationalMessage",message:"Accepted all!",icon:"Icon.80x80"})}(),c.completed()})),Office.actions.associate("rejectAllChanges",(async a=>{console.log("▶️ rejectAllChanges"),await async function(){s(t),await Word.run((async t=>{const s={matchWholeWord:!0,matchCase:!1},o=t.document.body.search("s",s),a=t.document.body.search("z",s);o.load("items"),a.load("items"),await t.sync();for(const e of[...o.items,...a.items])/^[sSzZ]$/.test(e.text.trim())&&(t.trackedObjects.add(e),e.font.highlightColor=null);await t.sync(),e.errors=[]})),o(t,{type:"informationalMessage",message:"Cleared all!",icon:"Icon.80x80"})}(),a.completed()})))}))}();
//# sourceMappingURL=commands.js.map