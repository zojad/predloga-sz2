!function(){"use strict";const t="noErrors";function e(t){if(!t)return null;const e=t.normalize("NFC").match(/[\p{L}0-9]/u);if(!e)return null;const o=e[0].toLowerCase(),n=new Set(["c","ƒç","f","h","k","p","s","≈°","t"]),c=/\d/.test(o)?{1:"e",2:"d",3:"t",4:"≈°",5:"p",6:"≈°",7:"s",8:"o",9:"d",0:"n"}[o]:o;return n.has(c)?"s":"z"}console.log("‚≠ê commands.js loaded"),Office.onReady((o=>{console.log("‚ñ∂Ô∏è Office.onReady",o),o.host===Office.HostType.Word&&(console.log("üîó Associating actions‚Ä¶"),Office.actions.associate("checkDocumentText",(function(){for(var o=arguments.length,n=new Array(o),c=0;c<o;c++)n[c]=arguments[c];return console.log("‚ñ∂Ô∏è OfficeAction invoked: checkDocumentText",n),async function(){var o;o=t,Office.NotificationMessages?.deleteAsync&&Office.NotificationMessages.deleteAsync(o),await Word.run((async o=>{const n=o.document.body.search("s",{matchWholeWord:!0,matchCase:!1}),c=o.document.body.search("z",{matchWholeWord:!0,matchCase:!1});n.load("items"),c.load("items"),await o.sync(),[...n.items,...c.items].forEach((t=>t.font.highlightColor=null)),await o.sync();const a=o.document.body.search("s",{matchWholeWord:!0,matchCase:!1}),s=o.document.body.search("z",{matchWholeWord:!0,matchCase:!1});a.load("items"),s.load("items"),await o.sync();const i=[];for(const t of[...a.items,...s.items]){const n=t.text.trim().toLowerCase();if("s"!==n&&"z"!==n)continue;const c=t.getRange("After").getNextTextRange([" ","\n",".",",",";","?","!"],!0);c.load("text"),await o.sync();const a=c.text.trim();if(!a)continue;const s=e(a);s&&n!==s&&(t.font.highlightColor="#FFC0CB",i.push(t))}i.length?(i[0].select(),await o.sync()):function(t){Office.NotificationMessages?.addAsync&&Office.NotificationMessages.addAsync(t,{type:"informationalMessage",message:"‚ú® No mismatches!",icon:"Icon.80x80"})}(t)}))}(...n)})),Office.actions.associate("acceptCurrentChange",(function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return console.log("‚ñ∂Ô∏è OfficeAction invoked: acceptCurrentChange",o),async function(){await Word.run((async t=>{const o=t.document.getSelection();o.load("text"),await t.sync();const n=o.text.trim().toLowerCase();if("s"!==n&&"z"!==n)return;const c=o.getRange("After").getNextTextRange([" ","\n",".",",",";","?","!"],!0);c.load("text"),await t.sync();const a=e(c.text.trim());a&&a!==n&&(o.insertText(a,Word.InsertLocation.replace),o.font.highlightColor=null,await t.sync());const s=o.getRange("After"),i=s.search("s",{matchWholeWord:!0,matchCase:!1}),r=s.search("z",{matchWholeWord:!0,matchCase:!1});i.load("items"),r.load("items"),await t.sync();for(const o of[...i.items,...r.items]){const n=o.text.trim().toLowerCase();if("s"!==n&&"z"!==n)continue;const c=o.getRange("After").getNextTextRange([" ","\n",".",",",";","?","!"],!0);c.load("text"),await t.sync();const a=e(c.text.trim());if(a&&a!==n)return o.select(),void await t.sync()}}))}(...o)})),Office.actions.associate("rejectCurrentChange",(function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return console.log("‚ñ∂Ô∏è OfficeAction invoked: rejectCurrentChange",o),async function(){await Word.run((async t=>{const o=t.document.getSelection();o.font.highlightColor=null,await t.sync();const n=o.getRange("After"),c=n.search("s",{matchWholeWord:!0,matchCase:!1}),a=n.search("z",{matchWholeWord:!0,matchCase:!1});c.load("items"),a.load("items"),await t.sync();for(const o of[...c.items,...a.items]){const n=o.text.trim().toLowerCase();if("s"!==n&&"z"!==n)continue;const c=o.getRange("After").getNextTextRange([" ","\n",".",",",";","?","!"],!0);c.load("text"),await t.sync();const a=e(c.text.trim());if(a&&a!==n)return o.select(),void await t.sync()}}))}(...o)})),Office.actions.associate("acceptAllChanges",(function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return console.log("‚ñ∂Ô∏è OfficeAction invoked: acceptAllChanges",o),async function(){await Word.run((async t=>{const o={matchWholeWord:!0,matchCase:!1},n=t.document.body.search("s",o),c=t.document.body.search("z",o);n.load("items"),c.load("items"),await t.sync();const a=[...n.items,...c.items].filter((t=>["s","z"].includes(t.text.trim().toLowerCase())));for(const o of a){const n=o.text.trim().toLowerCase(),c=o.getRange("After").getNextTextRange([" ","\n",".",",",";","?","!"],!0);c.load("text"),await t.sync();const a=e(c.text.trim());a&&a!==n&&(o.insertText(a,Word.InsertLocation.replace),o.font.highlightColor=null,await t.sync())}}))}(...o)})),Office.actions.associate("rejectAllChanges",(function(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];return console.log("‚ñ∂Ô∏è OfficeAction invoked: rejectAllChanges",e),async function(){await Word.run((async t=>{const e={matchWholeWord:!0,matchCase:!1},o=t.document.body.search("s",e),n=t.document.body.search("z",e);o.load("items"),n.load("items"),await t.sync(),[...o.items,...n.items].forEach((t=>t.font.highlightColor=null)),await t.sync()}))}(...e)})),console.log("‚úÖ Actions associated"))}))}();
//# sourceMappingURL=commands.js.map