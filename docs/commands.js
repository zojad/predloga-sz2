!function(){const e={errors:[],currentIndex:0};Office.onReady((e=>{e.host===Office.HostType.Word&&(Office.actions.associate("checkDocumentText",r),Office.actions.associate("acceptCurrentChange",o),Office.actions.associate("rejectCurrentChange",s),Office.actions.associate("acceptAllChanges",c),Office.actions.associate("rejectAllChanges",i),console.log("Ribbon commands registered."))}));const n=new Set(["p","t","k","f","s","š","c","č","h"]);function t(e){if(!e)return null;const t=[...e.toLowerCase()].find((e=>/[a-zčšž]/i.test(e)));return t?n.has(t)?"s":"z":null}async function r(){await Word.run((async n=>{const r=n.document.body,o=r.getTextRanges([" "],!0);o.load("items/text"),await n.sync();for(const n of e.errors)n.range.font.highlightColor=null;e.errors=[];for(let n=0;n<o.items.length-1;n++){const r=o.items[n].text.trim().toLowerCase(),s=o.items[n+1].text.trim();if("s"!==r&&"z"!==r)continue;const c=t(s);c&&c!==r&&(o.items[n].font.highlightColor="yellow",e.errors.push({index:n,range:o.items[n],suggestion:c}))}await n.sync(),e.errors.length>0?(e.currentIndex=0,e.errors[0].range.select()):r.insertComment("No incorrect 's/z' prepositions found.","start")}))}async function o(){e.currentIndex>=e.errors.length||await Word.run((async n=>{const t=e.errors[e.currentIndex],r=n.document.body.getTextRanges([" "],!0);r.load("items"),await n.sync();const o=r.items[t.index],s=o.text,c=/^[A-ZČŠŽ]/.test(s)?t.suggestion.toUpperCase():t.suggestion;o.insertText(c,Word.InsertLocation.replace),o.font.highlightColor=null,await n.sync(),e.errors.splice(e.currentIndex,1),e.currentIndex>=e.errors.length&&(e.currentIndex=0),e.errors.length>0&&e.errors[e.currentIndex].range.select()}))}async function s(){e.currentIndex>=e.errors.length||await Word.run((async n=>{e.errors[e.currentIndex].range.font.highlightColor=null,await n.sync(),e.errors.splice(e.currentIndex,1),e.currentIndex>=e.errors.length&&(e.currentIndex=0),e.errors.length>0&&e.errors[e.currentIndex].range.select()}))}async function c(){0!==e.errors.length&&await Word.run((async n=>{const t=n.document.body.getTextRanges([" "],!0);t.load("items"),await n.sync();for(const n of e.errors){const e=t.items[n.index],r=e.text,o=/^[A-ZČŠŽ]/.test(r)?n.suggestion.toUpperCase():n.suggestion;e.insertText(o,Word.InsertLocation.replace),e.font.highlightColor=null}await n.sync(),e.errors=[]}))}async function i(){0!==e.errors.length&&await Word.run((async n=>{for(const n of e.errors)n.range.font.highlightColor=null;await n.sync(),e.errors=[]}))}new Set(["b","d","g","v","z","ž","j","m","n","l","r","a","e","i","o","u"]),window.checkDocumentText=r,window.acceptCurrentChange=o,window.rejectCurrentChange=s,window.acceptAllChanges=c,window.rejectAllChanges=i}();
//# sourceMappingURL=commands.js.map