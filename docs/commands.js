!function(){function e(e,t){Office.NotificationMessages&&"function"==typeof Office.NotificationMessages.addAsync&&Office.NotificationMessages.addAsync(e,t)}window._SZ_functionsRegistered||(window._SZ_functionsRegistered=!0,Office.onReady((t=>{if(t.host===Office.HostType.Word)try{Office.actions.associate("checkDocumentText",o),Office.actions.associate("acceptAllChanges",i),Office.actions.associate("rejectAllChanges",l),Office.actions.associate("acceptCurrentChange",a),Office.actions.associate("rejectCurrentChange",c)}catch(t){console.error("Function registration failed:",t),e("regError",{type:"errorMessage",message:"Add-in initialization failed. Please reload.",persistent:!1})}})));const t={errors:[],currentIndex:0,isChecking:!1},r="#FFC0CB",n="noErrors";function s(e){if(!e)return null;const t=e.normalize("NFC").match(/[\p{L}0-9]/u);if(!t)return null;const r=t[0].toLowerCase(),n=new Set(["c","č","f","h","k","p","s","š","t"]);return/\d/.test(r)?n.has({1:"e",2:"d",3:"t",4:"š",5:"p",6:"š",7:"s",8:"o",9:"d",0:"n"}[r])?"s":"z":n.has(r)?"s":"z"}async function o(){if(!t.isChecking){var o;t.isChecking=!0,o=n,Office.NotificationMessages&&"function"==typeof Office.NotificationMessages.deleteAsync&&Office.NotificationMessages.deleteAsync(o);try{await Word.run((async o=>{t.errors.forEach((e=>e.range.font.highlightColor=null)),t.errors=[],t.currentIndex=0;const a={matchCase:!1,matchWholeWord:!0};let c=[];async function i(e){const t=e.search("\\b[sz]\\b",a);t.load("items"),await o.sync(),c.push(...t.items)}await i(o.document.body);const l=o.document.sections;l.load("items"),await o.sync();for(const e of l.items)await i(e.getHeader("Primary")),await i(e.getFooter("Primary"));const f=o.document.contentControls;f.load("items"),await o.sync();for(const e of f.items)await i(e);const g=o.document.body.tables;g.load("items"),await o.sync();for(const e of g.items)await i(e.getRange());const h=c.filter((e=>["s","z"].includes(e.text.trim().toLowerCase()))),d=[];for(const e of h){const t=e.getRange("After");t.expandTo(Word.TextRangeUnit.word),t.load("text"),await o.sync();const r=t.text.trim();if(!r)continue;const n=e.text.trim().toLowerCase(),a=s(r);a&&n!==a&&d.push({range:e,suggestion:a})}if(t.errors=d,0!==d.length){for(const e of d)e.range.font.highlightColor=r;await o.sync(),d[0].range.select()}else e(n,{type:"informationalMessage",message:"Ni najdenih napak.",icon:"Icon.80x80",persistent:!1})}))}catch(t){console.error("checkDocumentText failed:",t),e("checkError",{type:"errorMessage",message:"Preposition check failed. Please try again.",persistent:!1})}finally{t.isChecking=!1}}}async function a(){if(!(t.currentIndex>=t.errors.length))try{await Word.run((async e=>{const r=t.errors[t.currentIndex];r.range.insertText(r.suggestion,Word.InsertLocation.replace),r.range.font.highlightColor=null,await e.sync(),t.currentIndex++,t.currentIndex<t.errors.length&&t.errors[t.currentIndex].range.select()}))}catch(t){console.error("acceptCurrentChange failed:",t),e("acceptError",{type:"errorMessage",message:"Failed to apply change. Please re-run the check.",persistent:!1})}}async function c(){if(!(t.currentIndex>=t.errors.length))try{await Word.run((async e=>{t.errors[t.currentIndex].range.font.highlightColor=null,await e.sync(),t.currentIndex++,t.currentIndex<t.errors.length&&t.errors[t.currentIndex].range.select()}))}catch(t){console.error("rejectCurrentChange failed:",t),e("rejectError",{type:"errorMessage",message:"Failed to reject change. Please re-run the check.",persistent:!1})}}async function i(){if(t.errors.length)try{await Word.run((async e=>{for(const e of t.errors)e.range.insertText(e.suggestion,Word.InsertLocation.replace),e.range.font.highlightColor=null;await e.sync(),t.errors=[]}))}catch(t){console.error("acceptAllChanges failed:",t),e("acceptAllError",{type:"errorMessage",message:"Failed to apply all changes. Please try again.",persistent:!1})}}async function l(){if(t.errors.length)try{await Word.run((async e=>{for(const e of t.errors)e.range.font.highlightColor=null;await e.sync(),t.errors=[]}))}catch(t){console.error("rejectAllChanges failed:",t),e("rejectAllError",{type:"errorMessage",message:"Failed to clear changes. Please try again.",persistent:!1})}}window.checkDocumentText=o,window.acceptCurrentChange=a,window.rejectCurrentChange=c,window.acceptAllChanges=i,window.rejectAllChanges=l}();
//# sourceMappingURL=commands.js.map