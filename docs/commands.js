!function(){function e(e,t){Office.NotificationMessages&&"function"==typeof Office.NotificationMessages.addAsync&&Office.NotificationMessages.addAsync(e,t)}const t={errors:[],currentIndex:0,isChecking:!1},r="noErrors";function n(e){if(!e)return null;const t=e.normalize("NFC").match(/[\p{L}0-9]/u);if(!t)return null;const r=t[0].toLowerCase(),n=new Set(["c","č","f","h","k","p","s","š","t"]),o={1:"e",2:"d",3:"t",4:"š",5:"p",6:"š",7:"s",8:"o",9:"d",0:"n"};if(/\d/.test(r)){const e=o[r];return n.has(e)?"s":"z"}return n.has(r)?"s":"z"}async function o(){if(!t.isChecking){var o;t.isChecking=!0,o=r,Office.NotificationMessages&&"function"==typeof Office.NotificationMessages.deleteAsync&&Office.NotificationMessages.deleteAsync(o);try{await Word.run((async o=>{t.errors.forEach((e=>e.range.font.highlightColor=null)),t.errors=[],t.currentIndex=0;const s={matchCase:!1,matchWholeWord:!0};let a=[];async function c(e){const t=e.search("\\b[sz]\\b",s);t.load("items"),await o.sync(),a.push(...t.items)}await c(o.document.body);const i=o.document.sections;i.load("items"),await o.sync();for(const e of i.items)await c(e.getHeader("Primary")),await c(e.getFooter("Primary"));const l=o.document.contentControls;l.load("items"),await o.sync();for(const e of l.items)await c(e);const f=o.document.body.tables;f.load("items"),await o.sync();for(const e of f.items)await c(e.getRange());const g=a.filter((e=>["s","z"].includes(e.text.trim().toLowerCase()))),h=[];for(const e of g){const t=e.getRange("After");t.expandTo(Word.TextRangeUnit.word),t.load("text"),await o.sync();const r=t.text.trim();if(!r)continue;const s=e.text.trim().toLowerCase(),a=n(r);a&&s!==a&&h.push({range:e,suggestion:a})}if(t.errors=h,0!==h.length){for(const e of h)e.range.font.highlightColor="#FFC0CB";await o.sync(),h[0].range.select()}else e(r,{type:"informationalMessage",message:"Ni najdenih napak.",icon:"Icon.80x80",persistent:!1})}))}catch(t){console.error("checkDocumentText failed:",t),e("checkError",{type:"errorMessage",message:"Preposition check failed. Please try again.",persistent:!1})}finally{t.isChecking=!1}}}async function s(){if(!(t.currentIndex>=t.errors.length))try{await Word.run((async e=>{const r=t.errors[t.currentIndex];try{r.range.insertText(r.suggestion,Word.InsertLocation.replace),r.range.font.highlightColor=null}catch{return void await o()}await e.sync(),t.currentIndex++,t.currentIndex<t.errors.length&&t.errors[t.currentIndex].range.select()}))}catch(t){console.error("acceptCurrentChange failed:",t),e("acceptError",{type:"errorMessage",message:"Failed to apply change. Please re-run the check.",persistent:!1})}}async function a(){if(!(t.currentIndex>=t.errors.length))try{await Word.run((async e=>{t.errors[t.currentIndex].range.font.highlightColor=null,await e.sync(),t.currentIndex++,t.currentIndex<t.errors.length&&t.errors[t.currentIndex].range.select()}))}catch(t){console.error("rejectCurrentChange failed:",t),e("rejectError",{type:"errorMessage",message:"Failed to reject change. Please re-run the check.",persistent:!1})}}async function c(){if(t.errors.length)try{await Word.run((async e=>{for(const e of t.errors)e.range.insertText(e.suggestion,Word.InsertLocation.replace),e.range.font.highlightColor=null;await e.sync(),t.errors=[]}))}catch(t){console.error("acceptAllChanges failed:",t),e("acceptAllError",{type:"errorMessage",message:"Failed to apply all changes. Please try again.",persistent:!1})}}async function i(){if(t.errors.length)try{await Word.run((async e=>{for(const e of t.errors)e.range.font.highlightColor=null;await e.sync(),t.errors=[]}))}catch(t){console.error("rejectAllChanges failed:",t),e("rejectAllError",{type:"errorMessage",message:"Failed to clear changes. Please try again.",persistent:!1})}}Office.onReady((t=>{if(t.host===Office.HostType.Word)try{Office.actions.associate("checkDocumentText",o),Office.actions.associate("acceptAllChanges",c),Office.actions.associate("rejectAllChanges",i),Office.actions.associate("acceptCurrentChange",s),Office.actions.associate("rejectCurrentChange",a)}catch(t){console.error("Function registration failed:",t),e("regError",{type:"errorMessage",message:"Add-in initialization failed. Please reload.",persistent:!1})}})),window.checkDocumentText=o,window.acceptCurrentChange=s,window.rejectCurrentChange=a,window.acceptAllChanges=c,window.rejectAllChanges=i}();
//# sourceMappingURL=commands.js.map