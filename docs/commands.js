!function(){const e={errors:[],currentIndex:0,isChecking:!1},t="noErrors";function r(e){if(!e)return null;const t=e.normalize("NFC").match(/[\p{L}0-9]/u);if(!t)return null;const r=t[0].toLowerCase(),n=new Set(["c","č","f","h","k","p","s","š","t"]),s={1:"e",2:"d",3:"t",4:"š",5:"p",6:"š",7:"s",8:"o",9:"d",0:"n"};if(/\d/.test(r)){const e=s[r];return n.has(e)?"s":"z"}return n.has(r)?"s":"z"}async function n(){if(!e.isChecking){e.isChecking=!0,Office.NotificationMessages.deleteAsync(t);try{await Word.run((async n=>{e.errors.forEach((e=>e.range.font.highlightColor=null)),e.errors=[],e.currentIndex=0;const s={matchCase:!1,matchWholeWord:!0};let a=[];async function o(e){const t=e.search("\\b[sz]\\b",s);t.load("items"),await n.sync(),a.push(...t.items)}await o(n.document.body);const c=n.document.sections;c.load("items"),await n.sync();for(const e of c.items)await o(e.getHeader("Primary")),await o(e.getFooter("Primary"));const i=n.document.contentControls;i.load("items"),await n.sync();for(const e of i.items)await o(e);const l=n.document.body.tables;l.load("items"),await n.sync();for(const e of l.items)await o(e.getRange());const f=a.filter((e=>["s","z"].includes(e.text.trim().toLowerCase()))),g=[];for(const e of f){const t=e.getRange("After");t.expandTo(Word.TextRangeUnit.word),t.load("text"),await n.sync();const s=t.text.trim();if(!s)continue;const a=e.text.trim().toLowerCase(),o=r(s);o&&a!==o&&g.push({range:e,suggestion:o})}if(e.errors=g,0!==g.length){for(const e of g)e.range.font.highlightColor="#FFC0CB";await n.sync(),g[0].range.select()}else Office.NotificationMessages.addAsync(t,{type:"informationalMessage",message:"🎉 No mismatched ‘s’/‘z’ prepositions found.",icon:"Icon.80x80",persistent:!1})}))}catch(e){console.error("checkDocumentText failed:",e),Office.NotificationMessages.addAsync("checkError",{type:"errorMessage",message:"Preposition check failed. Please try again.",persistent:!1})}finally{e.isChecking=!1}}}async function s(){if(!(e.currentIndex>=e.errors.length))try{await Word.run((async t=>{const r=e.errors[e.currentIndex];try{r.range.insertText(r.suggestion,Word.InsertLocation.replace),r.range.font.highlightColor=null}catch{return void await n()}await t.sync(),e.currentIndex++,e.currentIndex<e.errors.length&&e.errors[e.currentIndex].range.select()}))}catch(e){console.error("acceptCurrentChange failed:",e),Office.NotificationMessages.addAsync("acceptError",{type:"errorMessage",message:"Failed to apply change. Please re-run the check.",persistent:!1})}}async function a(){if(!(e.currentIndex>=e.errors.length))try{await Word.run((async t=>{e.errors[e.currentIndex].range.font.highlightColor=null,await t.sync(),e.currentIndex++,e.currentIndex<e.errors.length&&e.errors[e.currentIndex].range.select()}))}catch(e){console.error("rejectCurrentChange failed:",e),Office.NotificationMessages.addAsync("rejectError",{type:"errorMessage",message:"Failed to reject change. Please re-run the check.",persistent:!1})}}async function o(){if(e.errors.length)try{await Word.run((async t=>{for(const t of e.errors)t.range.insertText(t.suggestion,Word.InsertLocation.replace),t.range.font.highlightColor=null;await t.sync(),e.errors=[]}))}catch(e){console.error("acceptAllChanges failed:",e),Office.NotificationMessages.addAsync("acceptAllError",{type:"errorMessage",message:"Failed to apply all changes. Please try again.",persistent:!1})}}async function c(){if(e.errors.length)try{await Word.run((async t=>{for(const t of e.errors)t.range.font.highlightColor=null;await t.sync(),e.errors=[]}))}catch(e){console.error("rejectAllChanges failed:",e),Office.NotificationMessages.addAsync("rejectAllError",{type:"errorMessage",message:"Failed to clear changes. Please try again.",persistent:!1})}}Office.onReady((e=>{if(e.host===Office.HostType.Word)try{Office.actions.associate("checkDocumentText",n),Office.actions.associate("acceptAllChanges",o),Office.actions.associate("rejectAllChanges",c),Office.actions.associate("acceptCurrentChange",s),Office.actions.associate("rejectCurrentChange",a)}catch(e){console.error("Function registration failed:",e),Office.NotificationMessages.addAsync("regError",{type:"errorMessage",message:"Add-in initialization failed. Please reload.",persistent:!1})}})),window.checkDocumentText=n,window.acceptCurrentChange=s,window.rejectCurrentChange=a,window.acceptAllChanges=o,window.rejectAllChanges=c}();
//# sourceMappingURL=commands.js.map