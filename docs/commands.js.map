{"version":3,"file":"commands.js","mappings":"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","sources":["webpack://office-addin-taskpane-js/./src/commands/commands.js"],"sourcesContent":["/* global Office, Word */\n\nconst state = {\n  errors: [],\n  currentIndex: 0,\n};\n\nOffice.onReady((info) => {\n  if (info.host === Office.HostType.Word) {\n    try {\n      Office.actions.associate(\"checkDocumentText\", checkDocumentText);\n      Office.actions.associate(\"acceptAllChanges\", acceptAllChanges);\n      Office.actions.associate(\"rejectAllChanges\", rejectAllChanges);\n      Office.actions.associate(\"acceptCurrentChange\", acceptCurrentChange);\n      Office.actions.associate(\"rejectCurrentChange\", rejectCurrentChange);\n    } catch (error) {\n      console.error(\"Function registration failed:\", error);\n    }\n  }\n});\n\nfunction determineCorrectPreposition(word) {\n  if (!word) return null;\n\n  const unvoicedConsonants = new Set(['c', 'č', 'f', 'h', 'k', 'p', 's', 'š', 't']);\n  const numberPronunciations = {\n    '1': 'e', '2': 'd', '3': 't', '4': 'š', '5': 'p',\n    '6': 'š', '7': 's', '8': 'o', '9': 'd', '0': 'n'\n  };\n\n  let firstChar = \"\";\n  for (const char of word) {\n    if (char.match(/[a-zA-ZčČšŠžŽ0-9]/)) {\n      firstChar = char.toLowerCase();\n      break;\n    }\n  }\n\n  if (!firstChar) return null;\n\n  if (firstChar >= '0' && firstChar <= '9') {\n    const pronunciation = numberPronunciations[firstChar];\n    return unvoicedConsonants.has(pronunciation) ? \"s\" : \"z\";\n  }\n\n  return unvoicedConsonants.has(firstChar) ? \"s\" : \"z\";\n}\n\nasync function checkDocumentText() {\n  try {\n    await Word.run(async (context) => {\n      state.errors.forEach(err => {\n        err.range.font.highlightColor = null;\n      });\n      state.errors = [];\n      state.currentIndex = 0;\n\n      const searchOptions = { matchCase: false, matchWholeWord: true };\n\n      const searchScopes = [\n        context.document.body,\n        context.document.sections.getFirst().getHeader(\"Primary\"),\n        context.document.sections.getFirst().getFooter(\"Primary\")\n      ];\n\n      let allResults = [];\n\n      for (const scope of searchScopes) {\n        const sResults = scope.search(\"s\", searchOptions);\n        const zResults = scope.search(\"z\", searchOptions);\n        sResults.load(\"items\");\n        zResults.load(\"items\");\n        await context.sync();\n        allResults.push(...sResults.items, ...zResults.items);\n      }\n\n      const results = allResults.filter((prep) => [\"s\", \"z\"].includes(prep.text.trim().toLowerCase()));\n\n      const errors = results.map(prep => {\n        try {\n          return {\n            prepositionRange: prep,\n            nextWordRange: prep.getNextTextRange(Word.TextRangeUnit.word)\n          };\n        } catch (err) {\n          console.warn(\"Failed to get next text range for:\", prep.text);\n          return null;\n        }\n      }).filter(Boolean);\n\n      errors.forEach(e => e.nextWordRange.load(\"text\"));\n      await context.sync();\n\n      state.errors = errors.map(({ prepositionRange, nextWordRange }) => {\n        const currentPrep = prepositionRange.text.trim().toLowerCase();\n        const correctPrep = determineCorrectPreposition(nextWordRange.text.trim());\n        if (!correctPrep) return null;\n        return currentPrep !== correctPrep ? {\n          range: prepositionRange,\n          suggestion: correctPrep\n        } : null;\n      }).filter(Boolean);\n\n      state.errors.forEach(err => {\n        err.range.font.highlightColor = \"Yellow\";\n      });\n\n      await context.sync();\n\n      if (state.errors.length > 0) {\n        state.errors[0].range.select();\n      } else {\n        console.log(\"No preposition errors found.\");\n      }\n    });\n  } catch (error) {\n    console.error(\"Document check failed:\", error);\n  }\n}\n\nasync function acceptCurrentChange() {\n  if (state.currentIndex >= state.errors.length) return;\n\n  try {\n    await Word.run(async (context) => {\n      const err = state.errors[state.currentIndex];\n      err.range.insertText(err.suggestion, Word.InsertLocation.replace);\n      err.range.font.highlightColor = null;\n      await context.sync();\n      state.currentIndex++;\n\n      if (state.currentIndex < state.errors.length) {\n        state.errors[state.currentIndex].range.select();\n      }\n    });\n  } catch (error) {\n    console.error(\"Failed to accept change:\", error);\n  }\n}\n\nasync function rejectCurrentChange() {\n  if (state.currentIndex >= state.errors.length) return;\n\n  try {\n    await Word.run(async (context) => {\n      const err = state.errors[state.currentIndex];\n      err.range.font.highlightColor = null;\n      await context.sync();\n      state.currentIndex++;\n\n      if (state.currentIndex < state.errors.length) {\n        state.errors[state.currentIndex].range.select();\n      }\n    });\n  } catch (error) {\n    console.error(\"Failed to reject change:\", error);\n  }\n}\n\nasync function acceptAllChanges() {\n  if (state.errors.length === 0) return;\n\n  try {\n    await Word.run(async (context) => {\n      for (const err of state.errors) {\n        err.range.insertText(err.suggestion, Word.InsertLocation.replace);\n        err.range.font.highlightColor = null;\n      }\n      await context.sync();\n      state.errors = [];\n    });\n  } catch (error) {\n    console.error(\"Failed to accept all changes:\", error);\n  }\n}\n\nasync function rejectAllChanges() {\n  if (state.errors.length === 0) return;\n\n  try {\n    await Word.run(async (context) => {\n      for (const err of state.errors) {\n        err.range.font.highlightColor = null;\n      }\n      await context.sync();\n      state.errors = [];\n    });\n  } catch (error) {\n    console.error(\"Failed to reject all changes:\", error);\n  }\n}\n\nwindow.checkDocumentText = checkDocumentText;\nwindow.acceptAllChanges = acceptAllChanges;\nwindow.rejectAllChanges = rejectAllChanges;\nwindow.acceptCurrentChange = acceptCurrentChange;\nwindow.rejectCurrentChange = rejectCurrentChange;\n\n"],"names":["state","errors","currentIndex","async","checkDocumentText","Word","run","forEach","err","range","font","highlightColor","searchOptions","matchCase","matchWholeWord","searchScopes","context","document","body","sections","getFirst","getHeader","getFooter","allResults","scope","sResults","search","zResults","load","sync","push","items","filter","prep","includes","text","trim","toLowerCase","map","prepositionRange","nextWordRange","getNextTextRange","TextRangeUnit","word","console","warn","Boolean","e","_ref","currentPrep","correctPrep","unvoicedConsonants","Set","numberPronunciations","firstChar","char","match","pronunciation","has","determineCorrectPreposition","suggestion","length","select","log","error","acceptCurrentChange","insertText","InsertLocation","replace","rejectCurrentChange","acceptAllChanges","rejectAllChanges","Office","onReady","info","host","HostType","actions","associate","window"],"sourceRoot":""}